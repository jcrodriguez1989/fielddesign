% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_cv_contour.R
\name{plot_cv_contour}
\alias{plot_cv_contour}
\title{Plot Contour of Predicted Coefficient of Variation (CV)}
\usage{
plot_cv_contour(
  fit,
  nr,
  nc,
  title = "CV Contour",
  xlab = "Width (number of plots)",
  ylab = "Length",
  mark = NULL,
  mark_col = "red",
  mark_lab = NULL
)
}
\arguments{
\item{fit}{A fitted model object (e.g., from `fit_exhaustive_optimal_plot_size`) that can
predict CV values.}

\item{nr}{An integer, specifying the maximum number of rows (Length) for the grid.}

\item{nc}{An integer, specifying the maximum number of columns (Width) for the grid.}

\item{title}{A character string for the main title of the plot.}

\item{xlab}{A character string for the x-axis label.}

\item{ylab}{A character string for the y-axis label.}

\item{mark}{A data frame with at least 'Length' and 'Width' columns, specifying points to mark
on the plot.}

\item{mark_col}{A character string, the color to use for the marked points.}

\item{mark_lab}{A character string, a label to display near the first marked point.}
}
\value{
A `ggplot` object, representing the generated CV contour plot.
}
\description{
This function generates a filled contour plot visualizing the predicted Coefficient of Variation
(CV) across a grid of Length and Width values, based on a provided fitted model. It can
optionally highlight specific points on the contour.
}
\examples{
\dontrun{
# Generate simulated data.
set.seed(420)
nr <- 10
nc <- 10
x <- matrix(rnorm(nr * nc, 500, 60), nrow = nr, ncol = nc)
# Calculate the exhaustive spatial variation.
sv_exh <- spatial_variation_exhaustive(x)$res
# Calculate the optimal plot size.
exh_ops <- fit_exhaustive_optimal_plot_size(sv_exh, nr, nc)
plot_cv_contour(
  exh_ops$fit,
  nr = nr, nc = nc,
  title = "EXHAUSTIVE — CV Contour (With interaction)",
  mark = data.frame(Length = exh_ops$h_opt, Width = exh_ops$w_opt),
  mark_col = "red",
  mark_lab = paste0("optimal (L=", exh_ops$h_opt, ", W=", exh_ops$w_opt, ")")
)
# Calculate the tiling spatial variation.
sv_tiling <- spatial_variation_tiling(x)$res
# Calculate the optimal plot size.
tiling_ops <- fit_exhaustive_optimal_plot_size(sv_tiling, nr, nc)
plot_cv_contour(
  tiling_ops$fit,
  nr = nr, nc = nc,
  title = "TILING — CV Contour (With interaction)",
  mark = data.frame(Length = tiling_ops$h_opt, Width = tiling_ops$w_opt),
  mark_col = "red",
  mark_lab = paste0("optimal (L=", tiling_ops$h_opt, ", W=", tiling_ops$w_opt, ")")
)
}

}
